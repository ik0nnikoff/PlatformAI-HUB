# üé§ Voice Services - PlatformAI-HUB

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ –≥–æ–ª–æ—Å–æ–≤—ã–º —Å–µ—Ä–≤–∏—Å–∞–º –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã PlatformAI-HUB, –≤–∫–ª—é—á–∞—é—â—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –Ω–∞—Å—Ç—Ä–æ–π–∫—É –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º.

---

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### 1. üèóÔ∏è [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](VOICE_ARCHITECTURE_DOCUMENTATION.md)
**–ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤**
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã
- –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö (STT/TTS)
- –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã (OpenAI, Google, Yandex)
- Fallback —Å–∏—Å—Ç–µ–º–∞ –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ü—Ä–∏–º–µ—Ä—ã –ø–æ–ª–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

### 2. üíª [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è Frontend](VOICE_FRONTEND_GUIDE.md)
**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞**
- TypeScript –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∏ —Ç–∏–ø—ã
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –º–æ–¥–µ–ª–µ–π –∏ –≥–æ–ª–æ—Å–æ–≤
- –ü—Ä–∏–º–µ—Ä—ã UI —Ñ–æ—Ä–º

### 3. üîå [API Reference](VOICE_API_REFERENCE.md)
**–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ API endpoints –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ endpoints
- STT/TTS API
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏–π
- –ú–µ—Ç—Ä–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞–º–∏

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–∞
```json
{
  "config": {
    "simple": {
      "settings": {
        "voice_settings": {
          "enabled": true,
          "intent_detection_mode": "keywords",
          "intent_keywords": ["–≥–æ–ª–æ—Å", "—Å–∫–∞–∂–∏", "–ø—Ä–æ–∏–∑–Ω–µ—Å–∏"],
          "providers": [
            {
              "provider": "openai",
              "priority": 1,
              "stt_config": {
                "enabled": true,
                "model": "whisper-1",
                "language": "ru"
              },
              "tts_config": {
                "enabled": true,
                "model": "tts-1",
                "voice": "nova"
              }
            }
          ]
        }
      }
    }
  }
}
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
```bash
# Health check –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
curl -X GET http://localhost:8000/api/v1/voice/health

# –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
curl -X POST http://localhost:8000/api/v1/voice/validate-config \
  -H "Content-Type: application/json" \
  -d '{"agent_id": "agent_123", "voice_settings": {...}}'
```

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ STT
```bash
# –ó–∞–≥—Ä—É–∑–∫–∞ –∞—É–¥–∏–æ—Ñ–∞–π–ª–∞ –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
curl -X POST http://localhost:8000/api/v1/voice/stt/process \
  -F "audio_file=@voice.ogg" \
  -F "agent_id=agent_123"
```

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# OpenAI
OPENAI_API_KEY=sk-...

# Google Cloud
GOOGLE_APPLICATION_CREDENTIALS=/path/to/credentials.json
GOOGLE_CLOUD_PROJECT_ID=your-project-id

# Yandex Cloud
YANDEX_API_KEY=your-api-key
YANDEX_FOLDER_ID=your-folder-id

# MinIO –¥–ª—è —Ñ–∞–π–ª–æ–≤
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_VOICE_BUCKET_NAME=voice-files
```

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã

| –ü—Ä–æ–≤–∞–π–¥–µ—Ä | STT | TTS | –Ø–∑—ã–∫–∏ | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ |
|-----------|-----|-----|-------|-------------|
| **OpenAI** | ‚úÖ Whisper | ‚úÖ TTS-1/HD | 50+ —è–∑—ã–∫–æ–≤ | –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π, –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ |
| **Google Cloud** | ‚úÖ Speech API | ‚úÖ Text-to-Speech | 100+ —è–∑—ã–∫–æ–≤ | –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ |
| **Yandex SpeechKit** | ‚úÖ STT | ‚úÖ TTS | –†—É—Å—Å–∫–∏–π, English | –õ—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ |

---

## üìä –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### ‚ú® –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- **Multi-provider support**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ —Å fallback
- **Intent detection**: –£–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–º–µ—Ä–µ–Ω–∏–π –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è
- **Caching**: Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ STT —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- **Rate limiting**: –ö–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–≥—Ä—É–∑–∫–∏ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- **File management**: MinIO —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∞—É–¥–∏–æ—Ñ–∞–π–ª–æ–≤
- **Real-time processing**: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ Telegram Bot

### üéØ –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã
- **Keywords**: –û–∑–≤—É—á–∏–≤–∞–Ω–∏–µ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- **Always**: –í—Å–µ–≥–¥–∞ –æ–∑–≤—É—á–∏–≤–∞—Ç—å –æ—Ç–≤–µ—Ç—ã
- **Disabled**: –¢–æ–ª—å–∫–æ STT, –±–µ–∑ TTS

### üîÑ Fallback –ª–æ–≥–∏–∫–∞
1. **Primary provider** (Priority 1) - –æ—Å–Ω–æ–≤–Ω–æ–π
2. **Secondary provider** (Priority 2) - –ø–µ—Ä–≤—ã–π fallback  
3. **Tertiary provider** (Priority 3) - –≤—Ç–æ—Ä–æ–π fallback
4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

---

## üõ†Ô∏è –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### Frontend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫
1. –ü—Ä–æ—á–∏—Ç–∞—Ç—å [Frontend Guide](VOICE_FRONTEND_GUIDE.md)
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ TypeScript –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
4. –°–æ–∑–¥–∞—Ç—å UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤

### Backend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫  
1. –ò–∑—É—á–∏—Ç—å [Architecture Documentation](VOICE_ARCHITECTURE_DOCUMENTATION.md)
2. –ü–æ–Ω–∏–º–∞—Ç—å –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö STT/TTS
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –∏ credentials
4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å [API Reference](VOICE_API_REFERENCE.md) –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### DevOps –∏–Ω–∂–µ–Ω–µ—Ä
1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
2. –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å MinIO –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
4. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

## üîç Troubleshooting

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

| –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|----------|---------|---------|
| "Voice services not initialized" | –ù–µ—Ç credentials | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è |
| "Voice settings not found" | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å | –ü—É—Ç—å: `config.simple.settings.voice_settings` |
| "STT service –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω" | –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –∏ credentials |
| "VOICE_MESSAGES_FORBIDDEN" | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback –Ω–∞ —Ç–µ–∫—Å—Ç |

### –õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
```
INFO - Voice service orchestrator initialized
INFO - Successfully initialized {provider} STT service
WARNING - Voice processing failed: {error}
ERROR - Failed to initialize voice services: {error}
```

---

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: TTL 24 —á–∞—Å–∞ –¥–ª—è STT —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- **Rate limiting**: 15 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- **Lazy loading**: –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é
- **Parallel processing**: –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤

### –ú–µ—Ç—Ä–∏–∫–∏
- –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ STT: ~1-3 —Å–µ–∫—É–Ω–¥—ã
- –í—Ä–µ–º—è —Å–∏–Ω—Ç–µ–∑–∞ TTS: ~2-5 —Å–µ–∫—É–Ω–¥  
- Cache hit rate: ~20-30%
- Success rate: >95% –ø—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

---

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –ö–æ–Ω—Ç–∞–∫—Ç—ã
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã**: –°–º. [Architecture Documentation](VOICE_ARCHITECTURE_DOCUMENTATION.md)
- **Frontend –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –°–º. [Frontend Guide](VOICE_FRONTEND_GUIDE.md)
- **API —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –°–º. [API Reference](VOICE_API_REFERENCE.md)

### –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏
- [OpenAI API Documentation](https://platform.openai.com/docs/api-reference/audio)
- [Google Cloud Speech API](https://cloud.google.com/speech-to-text/docs)
- [Yandex SpeechKit](https://cloud.yandex.ru/docs/speechkit/)

---

**–í–µ—Ä—Å–∏—è**: 1.0  
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: 15 —è–Ω–≤–∞—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ Production Ready

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç—É –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –≤ –≤–∞—à–∏—Ö –∞–≥–µ–Ω—Ç–∞—Ö! üöÄ
